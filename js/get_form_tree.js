function nth_parent(t,e){for(var r=t,n=0;n<e;n++){if(null==r||void 0===r.parentNode||null===r.parentNode)return null;r=r.parentNode}return r}function get_label(t){if(!t.hasAttribute("id"))return"LABEL"!==t.parentNode.tagName||t.previousSibling?null:t.parentNode;var e=document.querySelectorAll("label[for='"+t.getAttribute("id")+"']");if(0===e.length)return null;for(var r=0;r<e.length;r++)if(document.node_visible(e[r])&&""!==e[r].textContent.replace(/\s{2,}/gm," ").trim())return e[r];return null}function get_text_content(t){for(var e=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),r="";e.nextNode();)r+=e.currentNode.textContent.trim(),r+=" ";return r}var retry=!1;for(document.normalize();;){var root=0===document.forms.length||retry?document.querySelector("body"):document.forms[0],pos=0,list=[];let p=arguments;for(var walker=document.createTreeWalker(root,NodeFilter.SHOW_ALL,{acceptNode:function(t){if("OPTION"===t.tagName)return NodeFilter.FILTER_REJECT;if("SCRIPT"===t.tagName)return NodeFilter.FILTER_REJECT;if(!document.node_visible(t)){if(t.nodeType!==Node.ELEMENT_NODE)return NodeFilter.FILTER_REJECT;var e=get_label(t);if(null===e||!document.node_visible(e))return NodeFilter.FILTER_REJECT}pos++;let r=t.tagName;void 0!==r&&(r=r.toUpperCase());var n={},o=!0;let i=t.nodeType===Node.ELEMENT_NODE&&t.hasAttribute("class")?t.getAttribute("class").toLowerCase():"";var l=t.nodeType===Node.ELEMENT_NODE&&t.hasAttribute("role")?t.getAttribute("role").toLowerCase():"";if("SELECT"===r||"listbox"==l){n.type="mc",n.options=[];for(var u=t.querySelectorAll('option,[role="option"]'),s=0;s<u.length;s++)n.options.push({text:u[s].textContent})}else if(t.nodeType===Node.TEXT_NODE){if(n.text=t.textContent.replace(/\s{2,}/gm," ").trim(),""===n.text)return NodeFilter.FILTER_REJECT;o=!(n.type="txt")}else if("TEXTAREA"===r||"textbox"==l)n.type="ti";else if("number"==l||"range"==l||"tel"==l)n.type="number",n.max=parseInt(t.getAttribute("max")),n.min=parseInt(t.getAttribute("min")),n.step=parseInt(t.getAttribute("step"));else if("INPUT"===r){o=!1;e=t.getAttribute("type").toLowerCase();if("button"===e||"checkbox"===e||"radio"===e)n.type="btn";else if("text"===e||"textarea"===e)n.type="ti";else if("submit"===e)n.type="submit";else if("number"===e||"range"===e||"tel"===e)n.type="number",n.max=parseInt(t.getAttribute("max")),n.min=parseInt(t.getAttribute("min")),n.step=parseInt(t.getAttribute("step"));else{if(!t.hasAttribute("list"))return NodeFilter.FILTER_REJECT;if(n.type="mc",null===document.querySelector('datalist[id="'+t.getAttribute("list")+'"]'))return NodeFilter.FILTER_REJECT;n.options=[];for(var a=t.querySelectorAll('option,[role="option"]'),s=0;s<a.length;s++)n.options.push({text:a[s].textContent,node:a[s]})}}else if("BUTTON"===r||"MAT-CHECKBOX"===r||"MAT-RADIO-BUTTON"===r||"A"===t.tagName&&t.hasAttribute("href"))i.includes("dropdown")&&(n.nogroup=!0),t.hasAttribute("data-toggle")&&(n.nogroup=!0),n.type="btn";else if("LABEL"===r){if(t.hasAttribute("for")&&null!==document.querySelector("[id='"+t.getAttribute("for")+"']"))return NodeFilter.FILTER_REJECT;if(0<t.childNodes.length)return this.acceptNode(t.firstChild)}else{if("DATALIST"===r)return NodeFilter.FILTER_REJECT;if(t.nodeType!==Node.ELEMENT_NODE||"UL"===t.tagName)return NodeFilter.FILTER_ACCEPT;if(!(null!==t.onclick&&void 0!==t.onclick||"button"===l||"radio"===l||"checkbox"===l||t.hasAttribute("ng-click")||i.includes("btn")||i.includes("button")))return NodeFilter.FILTER_ACCEPT;t.hasAttribute("class")&&t.getAttribute("class").includes("dropdown")&&(n.nogroup=!0),t.hasAttribute("data-toggle")&&(n.nogroup=!0),n.type="btn"}t.nodeType===Node.ELEMENT_NODE&&(n.node=t,n.label=get_label(t),null!==n.label&&void 0!==n.label?n.text=n.label.textContent.replace(/\s{2,}/gm," ").trim():n.text=get_text_content(t).replace(/\s{2,}/gm," ").trim());for(s=0;s<p.length;s++)if(p[s]===t){n.nogroup=!0;break}return"btn"!==n.type&&((l=document.createRange()).selectNodeContents(t),0<(l=l.getClientRects()).length&&(n.rects=l[0])),n.pos=pos,list.push(n),o?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}});walker.nextNode(););for(var i=0;i<list.length;i++){var current=list[i];if("btn"===current.type&&!current.nogroup){var group=[i],prev=i;i++;for(var diff=-1,lt=!1;i<list.length;i++){let t=list[i];if("txt"!==t.type){if("btn"!==t.type||t.nogroup)break;if(-1===diff)diff=t.pos-current.pos,group.push(i),prev=i;else{if(t.pos-list[prev].pos!==diff){2===group.length&&(i-=2);break}group.push(i),prev=i}}}if(1<group.length)for(var j=0;j<group.length;j++)if(void 0===list[group[j]].lcp)for(var n=0,exit=!1,parent=null,glength=1;!exit;){if(n++,null===(parent=nth_parent(list[group[j]].node,n))){exit=!0;break}if("BODY"===parent.tagName)break;for(var hs,range,rects,k=0;k<group.length;k++)k!==j&&void 0===list[group[k]].lcp&&parent===nth_parent(list[group[k]].node,n)&&(hs=nth_parent(list[group[k]].node,n-1),list[group[k]].lcp=parent,void 0===list[group[k]].text&&(list[group[k]].text=hs.textContent.trim()),list[group[k]].pn=n,list[group[k]].hs=hs,glength++,exit=!0);exit&&(hs=nth_parent(list[group[j]].node,n-1),list[group[j]].lcp=parent,void 0===list[group[j]].text&&(list[group[j]].text=hs.textContent.trim()),list[group[j]].pn=n,list[group[j]].glength=glength,list[group[j]].hs=hs,(range=document.createRange()).selectNodeContents(hs),0<(rects=range.getClientRects()).length&&(list[group[j]].rects=rects[0]))}}}for(var empty=!0,i=0;i<list.length;i++){let t=list[i].type;if("txt"!==t&&("submit"!==t&&("btn"!==t||void 0!==list[i].glength))){empty=!1;break}}if(!empty||retry)break;retry=!0}return list;
